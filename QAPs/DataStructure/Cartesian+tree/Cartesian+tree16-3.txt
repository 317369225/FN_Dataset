How is malloc implemented?
malloc is a library call provided by the standard c library shipped with Unix-like operating systems. Most modern implementations use mmap MAP_ANONYMOUS to allocate(actually reserve) virtual address space for the calling process. This memory is managed by malloc implementation. Most malloc implementations use some kind of tree data structure (Cartesian tree, RB tree etc) to store the free blocks. Metadata is either stored at a fixed offset from the virtual address returned to the calling application(HP-UX implementation) or stored separately elsewhere.Â  Malloc grows the address space of a process(heap) when the current request can not be satisfied by its maintained free pool (either due to fragmentation or the request is too big) by calling mmap again. Advantages of using mmap over sbrk/brk are obvious. With mmap one can shrink the heap size by mumapping the contiguous unused pages in free list. 