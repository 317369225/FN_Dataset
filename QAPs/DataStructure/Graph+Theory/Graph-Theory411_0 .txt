Given an N vertex graph with m1 one way edges and m2 two way edges, how can we direct the two way edges such that we won't have any closed walks?If it is impossible, tell that it is impossible to do such thing.If some of the one-way edges already form a cycle, it is impossible. To check, just run a depth-first search only using one-way edges: if there are backward edges, there is a cycle, otherwise there are no cycles. If current one-way edges don’t form any cycles, it is always possible. Build a graph just of one-way edges - it will be an acyclic directed graph. Construct a topological order on the nodes then. Then direct each two-way edge in such a way that it leads from the earlier node to the later node in terms of topological order. No new cycles will appear, because all the edges now lead from earlier nodes to later nodes in the order, so there is no way to return earlier and form a cycle. The only corner case here is if some of the two-way edges are loops (go from a node to itself) - then it is impossible to direct them to avoid cycles. 202 Views · View Upvotes