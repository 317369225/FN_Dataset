How do I approach this graph problem? Is it NP-complete?
In general this problem appears to be NP-complete.  Suppose there is only 1 ship (and one port) which has enough capacity to satisfy all the cities.  Then the resulting problem looks like an instance of the Travelling Salesman Problem.  (In the TSP you must return to the origin, but omitting this requirement does not change the computational complexity.) At the other extreme, if M=1 and K=N (exactly as many ships and ports as cities) then the problem is that of finding the lowest-cost matching in a weighted bipartite graph, which can be solved in polynomial time (either O(V 2 E)  or O(V 2 logV+VE)    See Matching (graph theory). I don't know if other special cases could be identified that permit polynomial-time solutions, but the reduction to TSP shows that the problem is NP-complete. 