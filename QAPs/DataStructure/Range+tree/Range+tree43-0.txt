MapReduce Join?
sort-merge joins (using map-reduce jobs) can only do equi-joins. in cases like this - you would be better off doing what's called a 'map-side' joins (using map-only job). A. this seems relevant: [Hive-user] Working UDF for GeoIP lookup? - there's some code also floating around - but it's specific to a particular vendor's geoip dump. Â  B. if i had to do this really quickly on my own - i would: - distribute the geoip db via the distributed cache to all nodes (-files switch or 'add file' in hive). - in each mapper processing the log file, write some custom code to find the matching entry in the db for the IP address in the row. if you use hadoop streaming (or hive transform clause) - you can do it any language of your choice. for example - the geoip db can be loaded into a quick and fast db (like sqlite - the file pushed into distributed cache can be a sqlite db image you prepare up front one time) with indices on the from/upto fields - and then one can do a quick lookup for each row (ip >= from and ip<= to). (this would be the naiive approach - there's probably some type of range trees that are commonly used/available for these type of lookups that you can find specific to your language/OS). 