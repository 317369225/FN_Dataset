What algorithm should I use in this geometry problem?
For the rectangles, my idea would be to do coordinate compression and then use some data structure like a 2D Range Tree. But for circles thing get more complicated. One idea that comes to my mind is to imagine circles as rectangles and use the same idea as above but, instead of just "accepting", one need to verify for each of the candidates circles that the point lies in it. But, unfortunately, this solution can be linear to each point. So, lets try another approach (assuming that we can answer "offline"): Instead of querying how many circles contain a point, we do the opposite. That is, for each circle we update the answer of each point inside that circle. A simple implementation of this idea will not result in a better complexity than before but, if we use some data structure like a 2D Range Tree or a Quadtree and... "lazy propagation", we can achieve a better complexity. (It needs a very careful implementation) Hope it was helpful! Updated 48w ago