How do I solve range power sum query using treap?I am solving these problem SPOJ.com - Problem GSS8. Given query in l r k, answer Σ A[i] * (i - l + 1)^k modulo 2^32, for l <= i <= r. (0 <= k <= 10). What would be node structure to perform update operation in treap?I am not on SPOJ, dint see this problem earlier, below I am just guessing by reading the problem statement. The point #4 in question, the query l r k indirectly requires sum from L to R. That you can do by standard known fact of sum [1 to R] minus sum [1 to L-1] or similar. The above requires prefix summation of large values of a very large number of nodes. So it is better to have some sums stored at various nodes. But again you have delete and insert operations in the question, so I really doubt if Treap is a good DS based on operations that it supports which I had a quick glance at: Treap, they are only insert, delete, search, split, merge/union. If possible look at, Fenwick tree or Segment tree For Fenwick tree, as I remember update can be used to insert, dont remember there was a delete, you can on the same, or do a bit of clever work around. Node structure for Fenwick is just store the summation that you have, at each node. But this question looks to be a bit clever by including the i value in the summation. But you think hard enough you will find a solution. For Segment tree, here again, I dont remember delete operation, especially wikipedia says “It is, in principle, a static structure; that is, its structure cannot be modified once it is built” so a delete operation again here will need a bit of clever work around. Fenwick looks a bit better, but Sumod Mathilakath says segment tree, try & see what fits correcly. If all else fails, which looks unlikely, take a hint from Top 30 guy on SPOJ, who is a junior friend of mine. For this, ping me in comments, after your try enough. best of luck. 352 Views · View Upvotes · Answer requested by 1 person