What's the solution for the problem USUBQSUB on SPOJ?
Yes. I have solved a very very similar problem (Infact they are same). There are a few different solutions. 1. Range Update on 2D BIT 2. Range Update on Array of 1D BIT (Less efficient but easier to code) 3. Lazy Propagation on Array of 1D Segment Tree 4. Lazy Propagation on 2D Segment Tree/Quadtree I solved it using Lazy propagation on Quadtree. The idea is the same. In 1D Segment tree, we multiply the update value (lazy) by the size of the interval. In Quadtree, we will multiply it with the area of rectangle. For quadtree, we divide a rectangle into 4 parts just like we divided a linear range into 2 parts in 1D segment tree. I cannot give the code right now, because the same problem is in a live contest. 