★How does the Metropolis-Hastings algorithm work for Markov Chain Monte Carlo (MCMC) methods?
We can't really bypass the basic concept of Monte Carlo when understanding the Metropolis method. So let's start from there. Monte Carlo is defined as the sampling method using excess amount of random numbers, thus it is named after a casino. This definition really doesn't help much, so let's look at an example. This example is commonly referred to as "hit and miss". The procedure goes like this: you fire a number of random shots in the unit square. If it lands inside the unit circle, you count a hit. After many shots, the number can be estimated as (image from: www2.hawaii.edu) Another example is Buffon's needle: if a needle of length l is thrown onto parallel lines distance d apart (d>l), can be estimated as . (image from: mathforum.org) The Mathematician Lazzerini is the first one to estimate using this method. He got 3.1415929 after about 3000 shots. Modern computer simulations would tell you that you can get to 3 digit accuracy after 10,000,000 shots. So let's just say that Lazzerini had a really nice needle. Now that we have grasped the basic idea of Monte Carlo, let's apply it to atomistic simulations. The density for a configuration in the canonical ensemble is: . And a physical quantity A can be estimated as: So if we just randomly generate many configurations , the value of A can be obtained using the above formulations. In reality, it is a bad idea because most configurations would have exceedingly low weight and do not contribute much to the estimation of A. A remedy is to generate a distribution of configurations according to . This is when the idea of "importance sampling" (a.k.a MCMC sampling) comes in. This way you can avoid wasting time generating low-probability states. But how do we do that? Now we introduce a proposition: Suppose at each step a move is generated from x to x' with the odds . The probability distribution for configurations is consistent with , if is invariant under the move from x to x', i.e. . This condition seems quite difficult to implement. So we usually use a stronger condition called the "detailed balance": . The first scheme fulfilling the detailed balance was suggested by Metropolis: , if , otherwise. where is a symmetrical stochastic matrix of Markov chain. These are pretty much the essence of the Metropolis-Hastings algorithm. Nothing fancy!    Embed Quote