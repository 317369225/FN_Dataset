★What protocol does HomeKit use to communicate with its devices?I know that HomeKit uses Wi-Fi and Bluetooth. I'd like to know more about how does it discover the devices over WiFi and what protocol does it use to communicate to them.
HomeKit speaks HomeKit Accessory Protocol (HAP), which runs on top of a BLE/Bluetooth Smart or an HTTP/TCP/IP stack.  If an accessory does not support HAP directly a gateway is needed.  HomeKit manages the collection of accessories in a defined home, and let's you interact the the services provided by those accessories using iOS apps or Siri.  HomeKit takes care of accessory/bridge discovery and configuration, using HAP to communicate with those accessory devices and gateways. Check out WWDC sessions videos 213 and 701 for more info (access is free at Apple Developer).    HomeKit landing page -> HomeKit - Apple Developer