★How are IP addresses mapped to location?http://whatismyipaddress.com/ tells me I am in Stanford, CA.  How does it know this, based on IP address?
My company, Digital Envoy/Digital Element [www.digitalelement.com] really started true city level geotargeting online, back in 1999.  While some may use registry data as set forth above, this can be highly inaccurate.   ISPs or multinational companies, for example, only register their headquarters in the registries (to be used for contact purposes), rather than setting out where all of their IP addresses are, down to the point of presence level.   At DE, we use sophisticated methodologies that map the Internet's routing infrastructure as well as using anonymous user supplied information to determine the location of an IP address to a zip code level, with a high degree of accuracy.